# file-store
一个内存持久化的 kv 存储库

# 设计思路
- memory-mapped-file：内存映射文件 高性能文件读写 -> 操作系统负责刷盘（也可以手动刷）
- fileStore => 对应用提供的API，set, get, delete, compact ....
- kvUnit   => 最小的kv单元 get, set, delete 
- MetaFile => 纯二进制实现  kv，元信息，Key开始位置，结束为止，Value开始位置和结束位置，MetaFile当前写到的位置
- DataFile => 实际存储Key和value，以及当前写到什么Pos

Manifest
0001.meta
0001.data
...
000x.current ()

# 特性
1. 支持简单的kv操作
2. 非常搞的性能支持，可以支持每秒数百万的写入和每秒数千万的读取
3. 对应的内容完全磁盘持久化
4. 不支持事务，对同一个kv的操作务必自己保障线程安全
5. 持久化支持，但是极端场景下仍会有数据丢失
6. 支持手动调用持久化

如下场景数据会丢失
1. 系统异常断电
2. 磁盘不可用
3. 程序异常退出

为了保障数据的完整性，本系统启动的时候会检查数据完整标志。
如果完整标志存在则数据一定是完整的，如果不是完整的，业务方需要从备份恢复数据。


## 测试case
1. panic的时候，数据能保留多少条，完整不完整
    - panic 单线程不会丢
    - 多线 （待测试）
2. 被终止的时候
    - kill -9   会报错 【待测试丢数据否】, KILL 完的不能用
    - kill -15  不会丢
3. OOM KILL的时候
   
4. POD被删掉的时候
5. 性能问题，
    - Load性能问题
    - 单GET性能
    - 单SET性能
